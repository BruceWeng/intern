<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Browser test runner</title>
		<script src="node_modules/dojo/dojo.js"></script>
		<script>
			(function () {
				var existingOnError = window.onerror;
				window.onerror = function (message, url, lineNumber) {
					document.write(
						'<div style="font-family:sans-serif;padding:0 20px;border:solid 1px transparent">' +
						'<h2 style="background:#ffe0e0;padding:.5em 1em">Error</h2>' +
						'<p>An error occurred while loading your tests:</p>' +
						'<div><pre style="padding:4px 8px;background:#efefef;display:inline-block">' +
						message +
						'</pre></div>' +
						'<p>' + url + ':' + lineNumber + '</p>' +
						'</div>'
					);
					
					if (existingOnError) {
						return existingOnError.apply(null, arguments);
					}

					return false;
				};

				var basePath = location.pathname.replace(/\/+[^\/]*$/, '/');
				var	internConfig = this.__internConfig = {
					// For users running client.html directly, assume that the base path
					// is two levels up (the parent of node_modules); this is most common.
					// Users that need something special should provide an absolute module
					// path for the config module (e.g. `/path/to/intern/config`) and
					// then set `baseUrl` correctly in the `loader` configuration object
					// of the config module
					baseUrl: basePath.slice(-10) === '/__intern/' ? basePath.slice(0, -9) : (basePath + '../../'),
					packages: [
						{ name: 'intern', location: basePath }
					],
					map: {
						intern: {
							dojo: 'intern/node_modules/dojo',
							chai: 'intern/node_modules/chai/chai'
						},
						'*': {
							'intern/dojo': 'intern/node_modules/dojo'
						}
					}
				};

				require(internConfig, [ 'intern/client' ]);
			})();
		</script>
	</head>
	<body></body>
</html>
